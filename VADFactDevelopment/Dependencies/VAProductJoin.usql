@dmfp =
EXTRACT abccontributionmargin string,
	abcrevenue string,
	abctieup string,
	abcvalue string,
	altconfigid string,
	altinventcolorid string,
	altinventsizeid string,
	altinventstyleid string,
	altitemid string,
	assetgroupid_ru string,
	assetid_ru string,
	autoreportfinished string,
	axmdmcode string,
	barcodesetupid string,
	basecomparisonunitcode string,
	batchnumgroupid string,
	blockedonpos string,
	bomcalcgroupid string,
	bomlevel string,
	bommanualreceipt string,
	bomunitid string,
	commissiongroupid string,
	costgroupid string,
	costmodel string,
	customstariffcodetable_in_dir_exp string,
	customstariffcodetable_in_dir_imp string,
	customstariffcodetable_in_tariffcode_exp string,
	customstariffcodetable_in_tariffcode_imp string,
	custvendexternalitem_abccategory string,
	custvendexternalitem_custvendrelation string,
	custvendexternalitem_description string,
	custvendexternalitem_externalitemid string,
	custvendexternalitem_externalitemtxt string,
	custvendexternalitem_moduletype string,
	dateblocked string,
	datetoactivateitem string,
	datetobeblocked string,
	defaultdimension string,
	defaultordertype string,
	definitiongroup string,
	density string,
	depth string,
	displayproductnumber string,
	ecoresproductdimensiongroup_name string,
	ecoresproducttranslation_description string,
	ecoresproducttranslation_languageid string,
	ecoresproducttranslation_name string,
	ecoresstoragedimensiongroup_name string,
	ecorestrackingdimensiongroup_name string,
	epcmanager string,
	exceptioncode_br string,
	excisetariffcodes_in_tariffcode string,
	executionid string,
	eximproductgrouptable_in_productgroup string,
	fiscallifoavoidcalc string,
	fiscallifonormalvalue string,
	fiscallifonormalvaluecalc string,
	fitaxationorigin_br string,
	forecastdmpinclude string,
	grossdepth string,
	grossheight string,
	grosswidth string,
	groupid string,
	height string,
	icmsonservice_br string,
	intracode string,
	intrastatprocid_cz string,
	intraunit string,
	inventdim_configid string,
	inventdim_inventsizeid string,
	inventproducttype_br string,
	inventsiteid string,
	inventtablemoduleinvent_allocatemarkup string,
	inventtablemoduleinvent_enddisc string,
	inventtablemoduleinvent_linedisc string,
	inventtablemoduleinvent_markupseccur_ru string,
	inventtablemoduleinvent_maxiretprice_in string,
	inventtablemoduleinvent_maxpriceinclvat string,
	inventtablemoduleinvent_minpriceinclvat string,
	inventtablemoduleinvent_multilinedisc string,
	inventtablemoduleinvent_overdeliverypct string,
	inventtablemoduleinvent_pdspricprecision string,
	inventtablemoduleinvent_price string,
	inventtablemoduleinvent_pricedate string,
	inventtablemoduleinvent_priceinclvat string,
	inventtablemoduleinvent_priceqty string,
	inventtablemoduleinvent_priceseccur_ru string,
	inventtablemoduleinvent_priceunit string,
	inventtablemoduleinvent_suppitemgroupid string,
	inventtablemoduleinvent_taxitemgroupid string,
	inventtablemoduleinvent_underdeliverypct string,
	inventtablemoduleinvent_unitid string,
	inventtablemoduleinventpurch_enddisc string,
	inventtablemoduleinventsales_enddisc string,
	inventtablemodulepurch_allocatema string,
	inventtablemodulepurch_enddisc string,
	inventtablemodulepurch_linedisc string,
	inventtablemodulepurch_markupseccur_ru string,
	inventtablemodulepurch_maxiretprice_in string,
	inventtablemodulepurch_maxpriceinclvat string,
	inventtablemodulepurch_minpriceinclvat string,
	inventtablemodulepurch_multilinedisc string,
	inventtablemodulepurch_overdeliverypct string,
	inventtablemodulepurch_pdspricprecision string,
	inventtablemodulepurch_price string,
	inventtablemodulepurch_pricedate string,
	inventtablemodulepurch_priceinclvat string,
	inventtablemodulepurch_priceqty string,
	inventtablemodulepurch_priceseccur_ru string,
	inventtablemodulepurch_priceunit string,
	inventtablemodulepurch_suppitemgr string,
	inventtablemodulepurch_taxitemgroupid string,
	inventtablemodulepurch_underdeliverypct string,
	inventtablemodulepurch_unitid string,
	inventtablemodulesales_allocatema string,
	inventtablemodulesales_enddisc string,
	inventtablemodulesales_linedisc string,
	inventtablemodulesales_markupseccur_ru string,
	inventtablemodulesales_maxiretprice_in string,
	inventtablemodulesales_maxpriceinclvat string,
	inventtablemodulesales_minpriceinclvat string,
	inventtablemodulesales_multilinedisc string,
	inventtablemodulesales_overdeliverypct string,
	inventtablemodulesales_pdspricprecision string,
	inventtablemodulesales_price string,
	inventtablemodulesales_pricedate string,
	inventtablemodulesales_priceinclvat string,
	inventtablemodulesales_priceqty string,
	inventtablemodulesales_priceseccur_ru string,
	inventtablemodulesales_priceunit string,
	inventtablemodulesales_suppitemgr string,
	inventtablemodulesales_taxitemgroupid string,
	inventtablemodulesales_underdeliverypct string,
	inventtablemodulesales_unitid string,
	isselected string,
	itembuyergroupid string,
	itemdimcostprice string,
	itemgroupid string,
	itemid string,
	iteminventlocationid string,
	itempricetolerancegroupid string,
	itemtagginglevel string,
	itemtype string,
	keyinginprice string,
	keyinginqty string,
	lifefrom string,
	lifeto string,
	lowestqty string,
	markupcode_ru string,
	matchingpolicy string,
	minimumpalletquantity string,
	modelgroupid string,
	mustkeyincomment string,
	namealias string,
	netweight string,
	nodiscountallowed string,
	nrtaxgroup_lv string,
	origcountryregionid string,
	origcountyid string,
	origstateid string,
	packaginggroupid string,
	packing_ru string,
	pallettagging string,
	pbaautostart string,
	pbahideapproval string,
	pbahidedialog string,
	pbainventitemgroupid string,
	pbaitemautogenerated string,
	pbaitemconfigurable string,
	pbamandatoryconfig string,
	pdsbaseattributeid string,
	pdsbestbefore string,
	pdscwproduct string,
	pdscwwmsminimumpalletqty string,
	pdscwwmsqtyperlayer string,
	pdscwwmsstandardpalletqty string,
	pdsfreightallocationgroupid string,
	pdsitemrebategroupid string,
	pdspotencyattribrecording string,
	pdsshelfadvice string,
	pdsshelflife string,
	pdstargetfactor string,
	pdsvendorcheckitem string,
	phantom string,
	pkwiucode_pl string,
	pmfplanningitemid string,
	pmfproducttype string,
	pmfyieldpct string,
	primaryvendorid string,
	prodflushingprincip string,
	prodgroupid string,
	prodpoolid string,
	productsubtype string,
	producttype string,
	projcategoryid string,
	propertyid string,
	purchinventlocationid string,
	purchmodel string,
	qtybecomesnegative string,
	qtyperlayer string,
	releaseproductcompany string,
	reqgroupid string,
	sadratecode_pl string,
	salescontributionratio string,
	salesinventlocationid string,
	salesmodel string,
	salespercentmarkup string,
	salespricemodelbasic string,
	scaleitem string,
	scrapconst string,
	scrapvar string,
	searchname string,
	seasoncode string,
	serialnumgroupid string,
	servicecodetable_in_servicecode string,
	skipintracompanysync_ru string,
	sortcode string,
	standardconfigid string,
	standardinventcolorid string,
	standardinventsizeid string,
	standardpalletquantity string,
	statisticsfactor string,
	taraweight string,
	taxfiscalclassification_br string,
	taxpackagingqty string,
	taxservicecode_br string,
	transferstatus string,
	unitvolume string,
	usealtitemid string,
	useeanstandardbarcode string,
	variantconfigurationtechnology string,
	width string,
	wmsarrivalhandlingtime string,
	wmspallettypeid string,
	wmspickingqtytime string,
	zeropricevalid string,
	recversion string,
	[partition] string,
	recid string,
	batchmergedatecalculationmethod string,
	countgroupid string,
	filterchanged string,
	filtercode string,
	filtercode2_ string,
	filtercode3_ string,
	filtercode4_ string,
	filtergroup string,
	filtergroup2_ string,
	harmonizedcode string,
	inventiteminv_atpbackwarddemandtimefence string,
	inventiteminv_atpbackwardsupplytimefence string,
	inventiteminvent_atpapplydemandtimefence string,
	inventiteminvent_atpapplysupplytimefence string,
	inventiteminvent_atpinclplannedorders string,
	inventiteminvent_deliverydatecontroltype string,
	inventiteminvent_mandatoryinventlocation string,
	inventiteminventsetu_mandatoryinventsite string,
	inventiteminventsetup_atptimefence string,
	inventiteminventsetup_highestqty string,
	inventiteminventsetup_inventsitedefault string,
	inventiteminventsetup_leadtime string,
	inventiteminventsetup_lowestqty string,
	inventiteminventsetup_multipleqty string,
	inventiteminventsetup_override string,
	inventiteminventsetup_standardqty string,
	inventiteminventsetup_stopped string,
	inventitempurch_mandatoryinventlocation string,
	inventitempurchsetup_highestqty string,
	inventitempurchsetup_inventsitedefault string,
	inventitempurchsetup_leadtime string,
	inventitempurchsetup_lowestqty string,
	inventitempurchsetup_mandatoryinventsite string,
	inventitempurchsetup_multipleqty string,
	inventitempurchsetup_override string,
	inventitempurchsetup_standardqty string,
	inventitempurchsetup_stopped string,
	inventitemsal_atpbackwarddemandtimefence string,
	inventitemsal_atpbackwardsupplytimefence string,
	inventitemsales_atpapplydemandtimefence string,
	inventitemsales_atpapplysupplytimefence string,
	inventitemsales_deliverydatecontroltype string,
	inventitemsalessetu_atpinclplannedorders string,
	inventitemsalessetup_atptimefence string,
	inventitemsalessetup_highestqty string,
	inventitemsalessetup_inventsitedefault string,
	inventitemsalessetup_leadtime string,
	inventitemsalessetup_lowestqty string,
	inventitemsalessetup_multipleqty string,
	inventitemsalessetup_override string,
	inventitemsalessetup_standardqty string,
	inventlocationid string,
	inventmoduleinvent_allocatemarkup string,
	inventmoduleinvent_intercompanyblocked string,
	inventmoduleinvent_markup string,
	inventmoduleinvent_markupgroupid string,
	inventmodulepurch_allocatemarkup string,
	inventmodulepurch_intercompanyblocked string,
	inventmodulepurch_markup string,
	inventmodulepurch_markupgroupid string,
	inventmodulesales_allocatemarkup string,
	inventmodulesales_intercompanyblocked string,
	inventmodulesales_markup string,
	inventmodulesales_markupgroupid string,
	isreuseconfigurationenabled string,
	isvariantgenerationenabled string,
	mandatoryinventlocation string,
	mandatoryinventsite string,
	maxpickqty string,
	nmfccode string,
	overridesalesleadtime string,
	packageclassid string,
	packsizecateogryid string,
	pdscwmax string,
	pdscwmin string,
	pdscwunitid string,
	physdimid string,
	pickwcneg string,
	prodqty string,
	retailcolorgroupid string,
	retailsizegroupid string,
	retailstylegroupid string,
	rfdescription1 string,
	rfdescription2 string,
	standardinventstyleid string,
	stcccode string,
	stopped string,
	uomseqgroupid string,
	whsinventfixed_inventsiteid string,
	wmslocationid string
FROM @dmfproductentity
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@dmfpv =
EXTRACT definitiongroup string,
displayproductnumber string,
ecoresproducttranslation_description string,
ecoresproducttranslation_languageid string,
ecoresproducttranslation_name string,
executionid string,
inventcolorid string,
inventconfigid string,
inventsizeid string,
inventstyleid string,
isselected string,
itemid string,
retailvariantid string,
searchname string,
transferstatus string,
recversion string,
[partition] string,
recid string
FROM @dmfproductvariantentity
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@ep =
EXTRACT [productmaster] string,
	retaitotalweight string,
	variantconfigurationtechnology string,
	retailcolorgroupid string,
	retailsizegroupid string,
	retailstylegroupid string,
	instancerelationtype string,
	displayproductnumber string,
	searchname string,
	producttype string,
	pdscwproduct string,
	modifiedby string,
	recversion string,
	relationtype string,
	[partition] string,
	recid string,
	isproductvariantunitconversionenabled string,
	modifiedstring string,
	createdstring string,
	plmcolorcontrolmode string,
	plmconfigurationgroupid string,
	plmmaterialtypeenum string,
	plmsizerangeid string
FROM @ecoresproduct
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@ept1 =
EXTRACT [description] string,
name string,
product string,
languageid string,
modifiedby string,
recversion string,
[partition] string,
recid string,
modifiedstring string,
createdstring string
FROM @ecoresproducttranslation
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@ept= SELECT [description],
		name,
		product,
		languageid,
		modifiedby,
		recversion,
		[partition],
		recid,
		modifiedstring,
		createdstring
	FROM @ept1
	WHERE languageid=="en-us";

@epb =
EXTRACT brandcode string,
	branddescription string,
	modifiedstring string,
	createdstring string,
	dataareaid string,
	recversion string,
	[partition] string,
	recid string
FROM @egxproductbrand
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@idc =
EXTRACT itemid string,
	inventdimid string,
	distinctproductvariant string,
	retailvariantid string,
	createdstring string,
	dataareaid string,
	recversion string,
	[partition] string,
	recid string,
	modifiedstring string
FROM @inventdimcombination
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@iibc =
EXTRACT itembarcode string,
	itemid string,
	inventdimid string,
	barcodesetupid string,
	useforprinting string,
	useforinput string,
	description string,
	qty string,
	unitid string,
	retailvariantid string,
	retailshowforitem string,
	blocked string,
	modifiedstring string,
	del_modifiedtime string,
	modifiedby string,
	dataareaid string,
	recversion string,
	[partition] string,
	recid string,
	createdstring string
FROM @inventitembarcode
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@iigi =
EXTRACT itemid string,
  itemdataareaid string,
  itemgroupid string,
  itemgroupdataareaid string,
  recversion string,
  [partition] string,
  recid string,
  modifiedstring string,
  createdstring string
FROM @inventitemgroupitem
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@iip1 =
EXTRACT itemid string,
  versionid string,
  pricetype int?,
  inventdimid string,
  markup string,
  priceunit string,
  price string,
  pricecalcid string,
  unitid string,
  priceallocatemarkup string,
  priceqty string,
  stdcosttransdate string,
  stdcostvoucher string,
  costingtype string,
  activationdate string,
  priceseccur_ru string,
  markupseccur_ru string,
  modifiedstring string,
  createdstring string,
  dataareaid string,
  recversion string,
  [partition] string,
  recid string
FROM @inventitemprice
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@iip2 = SELECT ROW_NUMBER() OVER (PARTITION BY itemid, inventdimid ORDER BY activationdate DESC, createdstring DESC) AS rnk,
  itemid,
  versionid,
  pricetype,
  inventdimid,
  markup,
  priceunit,
  price,
  pricecalcid,
  unitid,
  priceallocatemarkup,
  priceqty,
  stdcosttransdate,
  stdcostvoucher,
  costingtype,
  activationdate,
  priceseccur_ru,
  markupseccur_ru,
  modifiedstring,
  createdstring,
  dataareaid,
  recversion,
  [partition],
  recid 
  FROM @iip1 
 WHERE pricetype ==0;
	
@iip = SELECT itemid,
  versionid,
  pricetype,
  inventdimid,
  markup,
  priceunit,
  price,
  pricecalcid,
  unitid,
  priceallocatemarkup,
  priceqty,
  stdcosttransdate,
  stdcostvoucher,
  costingtype,
  activationdate,
  priceseccur_ru,
  markupseccur_ru,
  modifiedstring,
  createdstring,
  dataareaid,
  recversion,
  [partition],
  recid FROM @iip2
	WHERE rnk==1;

@it =
EXTRACT itemid string,
  itemtype string,
  purchmodel string,
  height string,
  width string,
  salesmodel string,
  costgroupid string,
  reqgroupid string,
  epcmanager string,
  primaryvendorid string,
  netweight string,
  depth string,
  unitvolume string,
  bomunitid string,
  itempricetolerancegroupid string,
  density string,
  costmodel string,
  usealtitemid string,
  altitemid string,
  matchingpolicy string,
  intracode string,
  prodflushingprincip string,
  minimumpalletquantity string,
  pbaitemautogenerated string,
  wmsarrivalhandlingtime string,
  bommanualreceipt string,
  phantom string,
  intraunit string,
  bomlevel string,
  batchnumgroupid string,
  autoreportfinished string,
  origcountryregionid string,
  statisticsfactor string,
  altconfigid string,
  standardconfigid string,
  prodpoolid string,
  propertyid string,
  abctieup string,
  abcrevenue string,
  abcvalue string,
  abccontributionmargin string,
  commissiongroupid string,
  salespercentmarkup string,
  salescontributionratio string,
  salespricemodelbasic string,
  namealias string,
  prodgroupid string,
  projcategoryid string,
  grossdepth string,
  grosswidth string,
  grossheight string,
  standardpalletquantity string,
  qtyperlayer string,
  sortcode string,
  serialnumgroupid string,
  itembuyergroupid string,
  taxpackagingqty string,
  wmspallettypeid string,
  origstateid string,
  wmspickingqtytime string,
  taraweight string,
  packaginggroupid string,
  scrapvar string,
  scrapconst string,
  standardinventcolorid string,
  standardinventsizeid string,
  itemdimcostprice string,
  altinventsizeid string,
  altinventcolorid string,
  forecastdmpinclude string,
  product string,
  pallettagging string,
  itemtagginglevel string,
  defaultdimension string,
  fiscallifoavoidcalc string,
  fiscallifonormalvalue string,
  fiscallifonormalvaluecalc string,
  bomcalcgroupid string,
  inventfiscallifogroup string,
  ngpcodestable_fr string,
  origcountyid string,
  taxfiscalclassification_br string,
  pbaitemconfigurable string,
  pbainventitemgroupid string,
  pbahidedialog string,
  pbahideapproval string,
  pbaautostart string,
  pbamandatoryconfig string,
  inventproducttype_br string,
  taxationorigin_br string,
  taxservicecode_br string,
  excisetariffcodes_in string,
  customsexporttariffcodetable_in string,
  customsimporttariffcodetable_in string,
  servicecodetable_in string,
  eximproductgrouptable_in string,
  packing_ru string,
  assetgroupid_ru string,
  assetid_ru string,
  intrastatexclude string,
  intrastatprocid_cz string,
  pkwiucode_pl string,
  exceptioncode_br string,
  icmsonservice_br string,
  pdscwwmsstandardpalletqty string,
  pdscwwmsminimumpalletqty string,
  pdscwwmsqtyperlayer string,
  alcoholmanufacturerid_ru string,
  alcoholproductiontypeid_ru string,
  alcoholstrength_ru string,
  altinventstyleid string,
  approxtaxvalue_br string,
  batchmergedatecalculationmethod string,
  daxintegrationkey string,
  markupcode_ru string,
  nrtaxgroup_lv string,
  pdsbaseattributeid string,
  pdsbestbefore string,
  pdsfreightallocationgroupid string,
  pdsitemrebategroupid string,
  pdspotencyattribrecording string,
  pdsshelfadvice string,
  pdsshelflife string,
  pdstargetfactor string,
  pdsvendorcheckitem string,
  pmfplanningitemid string,
  pmfproducttype string,
  pmfyieldpct string,
  sadratecode_pl string,
  skipintracompanysync_ru string,
  standardinventstyleid string,
  modifiedstring string,
  del_modifiedtime string,
  modifiedby string,
  createdstring string,
  del_createdtime string,
  createdby string,
  dataareaid string,
  recversion string,
  [partition] string,
  recid string,
  dsa_in string,
  exciserecordtype_in string,
  carryover string,
  egxcarecode string,
  egxcutupsindicator string,
  egxfit string,
  egxlicenseitemindicator string,
  egxprepackproduct string,
  egxproductbrand string,
  egxproductclass string,
  egxproductcontents string,
  egxproductdresstype string,
  egxproductfabricgroup string,
  egxproductfabricpattern string,
  egxproductfabrictypertw string,
  egxproductgender string,
  egxproductheeltype string,
  egxproductlabel string,
  egxproductline string,
  egxproductsubclass string,
  plmcollectiongroup string,
  plmcolorcount string,
  plmdesignername string,
  plmfabriccontent string,
  plmproductitemcount string,
  plmproductspecificationname string,
  plmprojectedunits string,
  plmrefitemid string,
  plmreleasedproductstatus string,
  plmstdwholesaleprice string,
  plmstdwholesalepricecurrency string,
  plmsuggestedretailprice string,
  plmsuggestedretailpricecurrency string,
  plmtargetmarginpercentage string,
  plmtargetunits string,
  vsiavalarasalestaxgroup string,
  vsijeanstype string,
  vsimarketingtype string
FROM @inventtable
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@pdt1 =
EXTRACT  agreement string,
 itemcode int?,
 accountcode int?,
 itemrelation string,
 accountrelation string,
 quantityamountfrom string,
 fromdate string,
 todate string,
 amount string,
 currency string,
 percent1 string,
 percent2 string,
 deliverytime string,
 searchagain string,
 priceunit string,
 relation int?,
 quantityamountto string,
 unitid string,
 markup string,
 allocatemarkup string,
 module string,
 inventdimid string,
 calendardays string,
 genericcurrency string,
 mcrpricediscgrouptype string,
 mcrfixedamountcur string,
 mcrmerchandisingeventid string,
 agreementheaderext_ru string,
 disregardleadtime string,
 inventbaileefreedays_ru string,
 maximumretailprice_in string,
 originalpricediscadmtransrecid string,
 pdscalculationid string,
 modifiedstring string,
 dataareaid string,
 recversion string,
 [partition] string,
 recid string
FROM @pricedisctable
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@pdt = SELECT agreement,
 itemcode,
 accountcode,
 itemrelation,
 accountrelation,
 quantityamountfrom,
 fromdate,
 todate,
 amount,
 currency,
 percent1,
 percent2,
 deliverytime,
 searchagain,
 priceunit,
 relation,
 quantityamountto,
 unitid,
 markup,
 allocatemarkup,
 module,
 inventdimid,
 calendardays,
 genericcurrency,
 mcrpricediscgrouptype,
 mcrfixedamountcur,
 mcrmerchandisingeventid,
 agreementheaderext_ru,
 disregardleadtime,
 inventbaileefreedays_ru,
 maximumretailprice_in,
 originalpricediscadmtransrecid,
 pdscalculationid,
 modifiedstring,
 dataareaid,
 recversion,
 [partition],
 recid FROM @pdt1 
WHERE accountcode == 2 AND itemcode == 0 AND relation == 4 AND DateTime.Now >= Convert.ToDateTime(fromdate) AND (DateTime.Now <= Convert.ToDateTime(todate));

@rst =
EXTRACT seasoncode string,
 description string,
 enddate string,
 startdate string,
 dataareaid string,
 recversion string,
 [partition] string,
 recid string,
 plmseasontype string,
 plmyear string,
 modifiedstring string,
 createdstring string
FROM @retailseasontable
USING Extractors.Csv(silent:true,  skipFirstNRows: 1);

@productset = SELECT 
2 AS VAVersion, 
it.dataareaid AS BusinessUnitKey, 
ep.displayproductnumber AS itemnumber,
ept.[name] AS itemdescription, 
ept.description AS itemlongdescription, 
it.egxproductclass AS ItemHirarchylevl1,
it.egxproductsubclass AS ItemHirarchylevel2, 
(string)null AS ItemHirarchylevel3, 
(string)null AS ItemHirarchylevel4, 
it.egxproductbrand AS BrandID,
epb.branddescription AS BrandDescription, 
iigi.itemgroupid AS ItemTypeGroupCode, 
(string)null AS ItemTypeGroupDesc,
(string)null AS CountryOfOrigin, 
(string)null AS TargetCountry, 
(string)null AS DiscontinuedDate, 
iibc.barcodesetupid AS BarCodeType,
iibc.itembarcode AS ItemBarCode,
(string)null AS PrimaryUPC, 
(string)null AS [UPC], 
(string)null AS NonProfitInd, 
(string)null AS TaxInd, 
(string)null AS ScanTypeID,
(string)null AS ScanTypeDescription, 
rst.seasoncode AS SeasonName, 
rst.description AS SesonDescription, 
rst.startdate AS SeasonStartDate,
rst.enddate AS SeasonEndDate, 
rst.plmseasontype AS SeasonType, 
rst.plmyear AS SeasonYear, 
dmfpv.searchname AS VariantName,
dmfp.standardinventcolorid AS Color, 
dmfp.standardinventsizeid AS Size, 
dmfp.unitvolume AS Volume, 
dmfp.defaultdimension AS Dimensions,
dmfp.netweight AS Weight, 
it.egxproductgender AS ProdutGender, 
it.egxproductfabrictypertw AS ProductFabric, 
it.egxproductfabricpattern AS ProductFabricPattern,
it.egxproductheeltype AS ProductHeelType, 
it.egxproductdresstype AS ProductDressType, 
it.egxproductfabricgroup AS ProductFabricGroup, 
it.egxproductcontents AS ProductContents, 
it.egxfit AS ProductFit, 
it.egxcutupsindicator AS CutUps, 
it.vsijeanstype AS JeansTye,
(string)null AS BodyLength, 
it.egxcarecode AS FabricCare, 
(string)null AS SleeveLength, 
(string)null AS SleeveType, 
(string)null AS LengthType, 
(string)null AS Silhouette,
iip.price AS CurrentCost, 
pdt.amount AS CurrentRetailPrice, 
(string)null AS Commodity, 
(string)null AS PrimaryVendor, 
(string)null AS PricingMethod,
(string)null AS PriceMasterID, 
(string)null AS PriceMasterDescription,
1 AS ActiveInd, 
"dynamicsax" AS SourceSystem, 
DateTime.Now.ToString("M/d/yyyy") AS SourceCreatedDatetime,
(string)null AS SourceModifiedDatetime
FROM @it AS it 
	LEFT OUTER JOIN @idc AS idc ON it.itemid==idc.itemid AND it.dataareaid==idc.dataareaid AND it.[partition]==idc.[partition]
	LEFT OUTER JOIN @dmfp AS dmfp ON dmfp.itemid==idc.itemid AND dmfp.[partition]==idc.[partition]
	LEFT OUTER JOIN @dmfpv AS dmfpv ON dmfpv.itemid==idc.itemid AND dmfpv.[partition]==idc.[partition]
	LEFT OUTER JOIN @iip AS iip ON iip.itemid == it.itemid AND iip.dataareaid ==it.dataareaid AND iip.[partition] == it.[partition]  
	LEFT OUTER JOIN @pdt AS pdt ON pdt.itemrelation == it.itemid 
	LEFT OUTER JOIN @ep AS ep ON it.product==ep.recid AND it.[partition] == ep.[partition] 
	LEFT OUTER JOIN @ept AS ept ON ep.recid==ept.product AND ept.[partition]==ep.[partition]
	LEFT OUTER JOIN @epb AS epb ON it.egxproductbrand==epb.brandcode AND it.[partition]==epb.[partition] AND it.dataareaid==epb.dataareaid
	LEFT OUTER JOIN @iigi AS iigi ON it.itemid == iigi.itemid AND it.dataareaid == iigi.itemdataareaid
	LEFT OUTER JOIN @rst AS rst ON it.dataareaid == rst.dataareaid AND it.[partition] == rst.[partition]
	LEFT OUTER JOIN @iibc AS iibc ON idc.retailvariantid == iibc.retailvariantid AND idc.itemid == iibc.itemid AND idc.[partition] ==iibc.[partition] AND idc.dataareaid == iibc.dataareaid;

OUTPUT @productset
    TO @product
    USING Outputters.Csv(outputHeader: true);